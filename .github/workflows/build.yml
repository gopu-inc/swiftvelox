name: Notify Discord

on:
  push:
    branches:
      - main
  release:
    types: [published, released]

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Send Discord notification on push
        if: github.event_name == 'push'
        run: |
          curl -H "Content-Type: application/json" \
          -X POST \
          -d '{
            "embeds": [{
              "title": "üìÇ Nouveau commit sur main",
              "description": "Auteur: '${{ github.actor }}' | Message: '${{ github.event.head_commit.message }}'",
              "color": 3066993,
              "thumbnail": {
                "url": "https://img.shields.io/badge/certifi√©-‚úÖ-brightgreen.svg"
              },
              "footer": { "text": "‚úÖ Commit certifi√©" }
            }]
          }' \
          https://discord.com/api/webhooks/1465454947968614526/-7OTF0_zc9q_EQ347Y5PhRRAOzyENISnvByDE_N1MzcUH7ILx8Ym19LJfh88pDq53iLT

      - name: Send Discord notification on release
        if: github.event_name == 'release'
        run: |
          curl -H "Content-Type: application/json" \
          -X POST \
          -d '{
            "embeds": [{
              "title": "üöÄ Nouvelle release publi√©e",
              "url": "${{ github.event.release.html_url }}",
              "description": "Nom: '${{ github.event.release.name }}'",
              "color": 15105570,
              "thumbnail": {
                "url": "https://img.shields.io/badge/release-üèÖ-orange.svg"
              },
              "footer": { "text": "üèÖ Release certifi√©e" }
            }]
          }' \
          https://discord.com/api/webhooks/1465454947968614526/-7OTF0_zc9q_EQ347Y5PhRRAOzyENISnvByDE_N1MzcUH7ILx8Ym19LJfh88pDq53iLT
